// Parses a JSON encoded string
// --------------------------------------------------------------------------------
// @param [string] $source: JSON complete source
// @param [number] $pointer: current pointer
// --------------------------------------------------------------------------------
// @throw "Unterminated string."
// --------------------------------------------------------------------------------
// @return [list|false] (new pointer, parsed string / color / length)

@function _json-decode--string($source, $pointer) {
  // Check for the end of the string
  $temp: str-slice($source, $pointer);
  $end: str-index($temp, '"');
  $string: "";

  // If no end is found
  @if $end == 0 {
    @return _throw("Unterminated string.", $pointer);
  }

  @else if $end > 1 {
    $string: str-slice($temp, 1, $end - 1);
    $string: _strip-token($string, "\r");
    $string: _strip-token($string, "\n");
  }

  // Test whether the string could be a CSS length
  $string: _length($string);

  // Test whether the string could be a CSS color
  @if type-of($string) == string {
    $string: _color($string);
  }

  @return ($pointer + $end, $string);
}
